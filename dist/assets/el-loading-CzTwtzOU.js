import{B as P,bO as O,aQ as j,e as z,bP as R,a5 as b,j as Q,a6 as q,v as D,a7 as F,a1 as G,p as B,a4 as C,br as H,N as I,s as N,b3 as m,a2 as k,ad as S,bf as K,bQ as M}from"./index-C0YSzdoM.js";function Y(e,n){let t;const o=B(!1),s=P({...e,originalPosition:"",originalOverflow:"",visible:!1});function a(l){s.text=l}function c(){const l=s.parent,u=v.ns;if(!l.vLoadingAddClassList){let r=l.getAttribute("loading-number");r=Number.parseInt(r)-1,r?l.setAttribute("loading-number",r.toString()):(C(l,u.bm("parent","relative")),l.removeAttribute("loading-number")),C(l,u.bm("parent","hidden"))}d(),g.unmount()}function d(){var l,u;(u=(l=v.$el)==null?void 0:l.parentNode)==null||u.removeChild(v.$el)}function _(){var l;e.beforeClose&&!e.beforeClose()||(o.value=!0,clearTimeout(t),t=setTimeout(i,400),s.visible=!1,(l=e.closed)==null||l.call(e))}function i(){if(!o.value)return;const l=s.parent;o.value=!1,l.vLoadingAddClassList=void 0,c()}const p=z({name:"ElLoading",setup(l,{expose:u}){const{ns:r,zIndex:T}=R("loading");return u({ns:r,zIndex:T}),()=>{const L=s.spinner||s.svg,V=b("svg",{class:"circular",viewBox:s.svgViewBox?s.svgViewBox:"0 0 50 50",...L?{innerHTML:L}:{}},[b("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),E=s.text?b("p",{class:r.b("text")},[s.text]):void 0;return b(G,{name:r.b("fade"),onAfterLeave:i},{default:Q(()=>[q(D("div",{style:{backgroundColor:s.background||""},class:[r.b("mask"),s.customClass,r.is("fullscreen",s.fullscreen)]},[b("div",{class:r.b("spinner")},[V,E])]),[[F,s.visible]])])})}}}),g=O(p);Object.assign(g._context,n??{});const v=g.mount(document.createElement("div"));return{...j(s),setText:a,removeElLoadingChild:d,close:_,handleAfterLeave:i,vm:v,get $el(){return v.$el}}}let y;const A=function(e={},n){if(!H)return;const t=Z(e);if(t.fullscreen&&y)return y;const o=Y({...t,closed:()=>{var a;(a=t.closed)==null||a.call(t),t.fullscreen&&(y=void 0)}},n??A._context);J(t,t.parent,o),h(t,t.parent,o),t.parent.vLoadingAddClassList=()=>h(t,t.parent,o);let s=t.parent.getAttribute("loading-number");return s?s=`${Number.parseInt(s)+1}`:s="1",t.parent.setAttribute("loading-number",s),t.parent.appendChild(o.$el),I(()=>o.visible.value=t.visible),t.fullscreen&&(y=o),o},Z=e=>{var n,t,o,s;let a;return N(e.target)?a=(n=document.querySelector(e.target))!=null?n:document.body:a=e.target||document.body,{parent:a===document.body||e.body?document.body:a,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:a===document.body&&((t=e.fullscreen)!=null?t:!0),lock:(o=e.lock)!=null?o:!1,customClass:e.customClass||"",visible:(s=e.visible)!=null?s:!0,beforeClose:e.beforeClose,closed:e.closed,target:a}},J=async(e,n,t)=>{const{nextZIndex:o}=t.vm.zIndex||t.vm._.exposed.zIndex,s={};if(e.fullscreen)t.originalPosition.value=m(document.body,"position"),t.originalOverflow.value=m(document.body,"overflow"),s.zIndex=o();else if(e.parent===document.body){t.originalPosition.value=m(document.body,"position"),await I();for(const a of["top","left"]){const c=a==="top"?"scrollTop":"scrollLeft";s[a]=`${e.target.getBoundingClientRect()[a]+document.body[c]+document.documentElement[c]-Number.parseInt(m(document.body,`margin-${a}`),10)}px`}for(const a of["height","width"])s[a]=`${e.target.getBoundingClientRect()[a]}px`}else t.originalPosition.value=m(n,"position");for(const[a,c]of Object.entries(s))t.$el.style[a]=c},h=(e,n,t)=>{const o=t.vm.ns||t.vm._.exposed.ns;["absolute","fixed","sticky"].includes(t.originalPosition.value)?C(n,o.bm("parent","relative")):k(n,o.bm("parent","relative")),e.fullscreen&&e.lock?k(n,o.bm("parent","hidden")):C(n,o.bm("parent","hidden"))};A._context=null;const x=Symbol("ElLoading"),f=e=>`element-loading-${M(e)}`,w=(e,n)=>{var t,o,s,a;const c=n.instance,d=l=>S(n.value)?n.value[l]:void 0,_=l=>{const u=N(l)&&c?.[l]||l;return B(u)},i=l=>_(d(l)||e.getAttribute(f(l))),p=(t=d("fullscreen"))!=null?t:n.modifiers.fullscreen,g={text:i("text"),svg:i("svg"),svgViewBox:i("svgViewBox"),spinner:i("spinner"),background:i("background"),customClass:i("customClass"),fullscreen:p,target:(o=d("target"))!=null?o:p?void 0:e,body:(s=d("body"))!=null?s:n.modifiers.body,lock:(a=d("lock"))!=null?a:n.modifiers.lock},v=A(g);v._context=$._context,e[x]={options:g,instance:v}},U=(e,n)=>{for(const t of Object.keys(e))K(e[t])&&(e[t].value=n[t])},$={mounted(e,n){n.value&&w(e,n)},updated(e,n){const t=e[x];if(!n.value){t?.instance.close(),e[x]=null;return}t?U(t.options,S(n.value)?n.value:{text:e.getAttribute(f("text")),svg:e.getAttribute(f("svg")),svgViewBox:e.getAttribute(f("svgViewBox")),spinner:e.getAttribute(f("spinner")),background:e.getAttribute(f("background")),customClass:e.getAttribute(f("customClass"))}):w(e,n)},unmounted(e){var n;(n=e[x])==null||n.instance.close(),e[x]=null}};$._context=null;export{$ as v};
