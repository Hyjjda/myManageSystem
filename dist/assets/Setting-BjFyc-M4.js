import"./base-ViztKN45.js";import{v as G}from"./el-loading-CzTwtzOU.js";import{b as H,a as Y,E as J}from"./el-table-column-BBO3a5M-.js";import{E as Q}from"./el-tag-CzaBJyrM.js";import{E as W,a as X}from"./el-select-CZWxLfJ5.js";import"./el-scrollbar-4E6cCh5w.js";import"./el-popper-CyS72pHA.js";import{E as Z}from"./el-input-D-02Qznu.js";import{E as ee,a as te}from"./el-checkbox-CuP0MMfy.js";/* empty css                   */import{E as D}from"./el-card-tD9eT-br.js";import{E as ae,a as le}from"./el-col-Bi6DIMnx.js";import{E as T}from"./el-button-CTMz-c1B.js";import{u as oe}from"./useHttp-Qilkyp6n.js";import{E as ne}from"./el-dialog-nJ4b-Y-0.js";import"./el-overlay-CSCNvUz8.js";/* empty css                          */import{E as re}from"./el-tree-CcNY92mx.js";import"./el-text-9H7jJQUg.js";import{aI as q,e as P,ax as se,p as c,h as j,j as a,v as e,Y as A,z as i,o as L,g as ue,k as p,$ as pe,a6 as ie,aj as B}from"./index-C0YSzdoM.js";import{a as me}from"./index-C1myhlI6.js";import"./typescript-Bp3YSIOJ.js";import"./event-DYMifAw6.js";import"./isArrayLikeObject-6WTalTKa.js";import"./aria-Cl9uGz3Y.js";import"./omit-CMBK0oSN.js";import"./debounce-DQ2yIMUC.js";import"./raf-07j3bqRV.js";import"./use-form-common-props-DGImsqfa.js";import"./index-WcL-sAz5.js";import"./index-AkxRptXk.js";import"./_baseFindIndex-D7XfJLKM.js";import"./vnode-4RZoeRcS.js";import"./refs-D6FW0B1r.js";import"./index-CkIw79Du.js";import"./index-W984IpZy.js";const I=m=>m.map(s=>{const n={label:s.name,url:s.url};return s.children&&(n.children=I(s.children)),n}),de=m=>q("/userAuth",{pageAuthority:m}),ce=(m,s,n)=>q("/setAuth",{btnList:m,pageList:s,account:n}),fe={class:"dialog-footer"},_e=P({__name:"authModal",props:{visable:{type:Boolean,required:!0},keys:{type:Array,required:!0},btnAuth:{type:Array,required:!0},account:{type:String,required:!0}},emits:["close"],setup(m,{emit:s}){const n=se(),h=m,E=c(),z=c(I(n.menu)),v=c([]),S=()=>{E.value.setCheckedKeys(h.keys),v.value=h.btnAuth},b=s,V=async()=>{const f=await ce(v.value,E.value.getCheckedKeys(!0),h.account);f.code===200&&me({type:"success",message:f.msg}),b("close")};return(f,o)=>{const $=re,C=D,_=te,w=ee,x=T,g=ne;return L(),j(g,{title:"权限设置","model-value":m.visable,width:"600px",onOpen:S,onClose:o[2]||(o[2]=t=>f.$emit("close"))},{footer:a(()=>[A("div",fe,[e(x,{onClick:o[1]||(o[1]=t=>f.$emit("close"))},{default:a(()=>[...o[5]||(o[5]=[i("取消",-1)])]),_:1}),e(x,{onClick:V,type:"primary"},{default:a(()=>[...o[6]||(o[6]=[i("更新",-1)])]),_:1})])]),default:a(()=>[e(C,null,{header:a(()=>[...o[3]||(o[3]=[A("div",{class:"card-header"},[A("span",null,"权限")],-1)])]),default:a(()=>[e($,{"show-checkbox":"",data:z.value,"max-width":"600px","node-key":"url",ref_key:"treeRef",ref:E},null,8,["data"])]),_:1}),e(C,{class:"mt"},{header:a(()=>[...o[4]||(o[4]=[A("div",{class:"card-header"},[A("span",null,"按钮权限")],-1)])]),default:a(()=>[e(w,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=t=>v.value=t),class:"mt"},{default:a(()=>[e(_,{label:"全部",value:"all"}),e(_,{label:"添加",value:"add"}),e(_,{label:"编辑",value:"edit"}),e(_,{label:"删除",value:"delete"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value"])}}}),Ze=P({__name:"Setting",setup(m){const s=c(!1),n=c({name:"",department:""}),h=()=>{n.value={name:"",department:""},o()},{dataList:E,loading:z,loadData:v,totals:S,pageInfo:b,handleSizeChange:V,handleCurrentChange:f,resetPagination:o}=oe("/permissionList",n),$=g=>{const t=[];function y(r){r.url&&!r.children&&t.push(r.url),r.children&&r.children.forEach(d=>y(d))}return g.forEach(r=>y(r)),t},C=c([]),_=c([]),w=c(""),x=async(g,t)=>{const{data:{btn:y,list:r}}=await de(g);C.value=$(r),_.value=y,w.value=t,s.value=!0};return(g,t)=>{const y=Z,r=le,d=X,M=W,k=T,R=ae,N=D,u=Y,U=Q,K=J,O=H,F=G;return L(),ue(pe,null,[e(N,null,{default:a(()=>[e(R,{gutter:20},{default:a(()=>[e(r,{span:6},{default:a(()=>[e(y,{modelValue:n.value.name,"onUpdate:modelValue":t[0]||(t[0]=l=>n.value.name=l),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),e(r,{span:6},{default:a(()=>[e(M,{placeholder:"请选择部门",modelValue:n.value.department,"onUpdate:modelValue":t[1]||(t[1]=l=>n.value.department=l)},{default:a(()=>[e(d,{label:"全部",value:""}),e(d,{label:"总裁",value:"总裁办"}),e(d,{label:"蓝室",value:"蓝室"}),e(d,{label:"黑室",value:"黑室"}),e(d,{label:"离心",value:"离心"}),e(d,{label:"浮力",value:"浮力"}),e(d,{label:"火发",value:"火发"})]),_:1},8,["modelValue"])]),_:1}),e(r,{span:6},{default:a(()=>[e(k,{type:"primary",onClick:p(v)},{default:a(()=>[...t[5]||(t[5]=[i("查询",-1)])]),_:1},8,["onClick"]),e(k,{onClick:h},{default:a(()=>[...t[6]||(t[6]=[i("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),e(N,null,{default:a(()=>[ie((L(),j(K,{data:p(E),class:"mt"},{default:a(()=>[e(u,{type:"index",label:"序号",width:"80"}),e(u,{prop:"account",label:"账号"}),e(u,{prop:"name",label:"姓名"}),e(u,{prop:"phone",label:"电话"}),e(u,{prop:"idNo",label:"身份证号"}),e(u,{prop:"position",label:"职位"},{default:a(l=>[e(U,null,{default:a(()=>[i(B(l.row.position),1)]),_:2},1024)]),_:1}),e(u,{prop:"department",label:"部门"}),e(u,{prop:"pageAuthority",label:"页面权限"},{default:a(l=>[e(U,{type:"success"},{default:a(()=>[i(B(l.row.pageAuthority),1)]),_:2},1024)]),_:1}),e(u,{prop:"btnAuthority",label:"按钮权限"},{default:a(l=>[e(U,{type:"info"},{default:a(()=>[i(B(l.row.btnAuthority),1)]),_:2},1024)]),_:1}),e(u,{prop:"opera",label:"操作",width:"280"},{default:a(l=>[e(k,{type:"primary",size:"small",onClick:ve=>x(l.row.pageAuthority,l.row.account)},{default:a(()=>[...t[7]||(t[7]=[i(" 权限设置 ",-1)])]),_:1},8,["onClick"]),e(k,{type:"danger",size:"small"},{default:a(()=>[...t[8]||(t[8]=[i(" 删除 ",-1)])]),_:1}),e(k,{type:"danger",size:"small"},{default:a(()=>[...t[9]||(t[9]=[i(" 禁用 ",-1)])]),_:1})]),_:1})]),_:1},8,["data"])),[[F,p(z)]])]),_:1}),e(_e,{visable:s.value,keys:C.value,btnAuth:_.value,account:w.value,onClose:t[2]||(t[2]=l=>s.value=!1)},null,8,["visable","keys","btnAuth","account"]),e(O,{class:"fr mt mb","current-page":p(b).page,"onUpdate:currentPage":t[3]||(t[3]=l=>p(b).page=l),"page-size":p(b).pageSize,"onUpdate:pageSize":t[4]||(t[4]=l=>p(b).pageSize=l),"page-sizes":[10,20,30],background:"",layout:"total, sizes, prev, pager, next, jumper",total:p(S),onSizeChange:p(V),onCurrentChange:p(f)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])],64)}}});export{Ze as default};
